(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{EIcB:function(e,t,n){"use strict";n.r(t),n.d(t,"ConsultEventPageModule",(function(){return _}));var i=n("ofXK"),o=n("3Pt+"),r=n("TEn/"),s=n("tyNb"),c=n("mrSG"),a=n("Bfh1"),l=n("AC/E"),b=n("gcxx"),d=n("fXoL"),u=n("e8h1");function m(e,t){if(1&e&&(d.Sb(0,"ion-select-option",29),d.Cc(1),d.Rb()),2&e){const e=t.$implicit;d.mc("value",e.FK_Id_Sucursal),d.Bb(1),d.Ec(" ",e.Sucursal," ")}}function h(e,t){if(1&e&&(d.Sb(0,"ion-select-option",29),d.Cc(1),d.Rb()),2&e){const e=t.$implicit;d.mc("value",e.FK_Id_Municipio),d.Bb(1),d.Dc(e.Municipio)}}function g(e,t){if(1&e&&(d.Sb(0,"ion-select-option",29),d.Cc(1),d.Rb()),2&e){const e=t.$implicit;d.mc("value",e),d.Bb(1),d.Ec(" ",e.Evento," ")}}function p(e,t){if(1&e){const e=d.Tb();d.Sb(0,"form",11),d.Sb(1,"ion-list"),d.Sb(2,"ion-item",12),d.Nb(3,"ion-icon",13),d.Sb(4,"ion-label",14),d.Cc(5,"Fecha evento"),d.Rb(),d.Rb(),d.Nb(6,"ion-datetime",15),d.Sb(7,"ion-item",12),d.Nb(8,"ion-icon",16),d.Sb(9,"ion-label",14),d.Cc(10,"Sucursal"),d.Rb(),d.Rb(),d.Sb(11,"ion-select",17),d.ac("ionChange",(function(t){return d.tc(e),d.ec().selectedBranchOffice(t)})),d.Ac(12,m,2,2,"ion-select-option",18),d.Rb(),d.Sb(13,"ion-item",12),d.Sb(14,"ion-thumbnail",19),d.Nb(15,"ion-img",20),d.Rb(),d.Sb(16,"ion-label",14),d.Cc(17,"Municipio"),d.Rb(),d.Rb(),d.Sb(18,"ion-select",21),d.ac("ionChange",(function(t){return d.tc(e),d.ec().selectedMunicipy(t)})),d.Ac(19,h,2,2,"ion-select-option",18),d.Rb(),d.Sb(20,"ion-item",12),d.Nb(21,"ion-icon",22),d.Sb(22,"ion-label",14),d.Cc(23,"Evento"),d.Rb(),d.Rb(),d.Sb(24,"ion-select",23),d.Ac(25,g,2,2,"ion-select-option",18),d.Rb(),d.Sb(26,"ion-item",24),d.Nb(27,"ion-icon",25),d.Sb(28,"ion-label"),d.Cc(29," Geoposici\xf3n "),d.Rb(),d.Sb(30,"ion-toggle",26),d.ac("ionChange",(function(t){return d.tc(e),d.ec().changeGeo(t)})),d.Rb(),d.Rb(),d.Sb(31,"ion-item",27),d.Nb(32,"ion-input",28),d.Rb(),d.Rb(),d.Rb()}if(2&e){const e=d.ec();d.mc("formGroup",e.formConsultEvent),d.Bb(6),d.mc("value",e.dateEvent)("min",e.dateMin)("pickerOptions",e.customPickerOption),d.Bb(6),d.mc("ngForOf",e.branchOffices),d.Bb(7),d.mc("ngForOf",e.municipalities),d.Bb(6),d.mc("ngForOf",e.eventsBranchOffice)}}const f=[{path:"",component:(()=>{class e{constructor(e,t,n,i,o,r,s,c){this.formBuilder=e,this.eventService=t,this.cacheService=n,this.loadingCtlr=i,this.storage=o,this.alertController=r,this.geolocation=s,this.router=c,this.dateMin=Date(),this.months=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],this.branchOffices=[],this.municipalities=[],this.eventsBranchOffice=[]}ionViewWillEnter(){this.dateEvent=(new Date).toISOString(),this.dateMin=this.dateEvent.split("T")[0]}ionViewDidEnter(){this.createFormConsultEvent(),this.getBranchsEvent()}ngOnInit(){}createFormConsultEvent(){this.formConsultEvent=this.formBuilder.group({dateEvent:[{value:this.dateEvent,disabled:!0},o.q.required],branchOffice:["",o.q.required],municipality:["",o.q.required],event:["",o.q.required],geo:[!1,o.q.required],geoText:[""]})}getBranchsEvent(){return Object(c.a)(this,void 0,void 0,(function*(){yield this.presentLoading(),setTimeout(()=>{this.eventService.getBranchOfficeEvent().subscribe(e=>{this.branchOffices=e.Sucursales,this.loading.dismiss()},e=>{this.loading.dismiss()})},1500)}))}selectedBranchOffice(e){return Object(c.a)(this,void 0,void 0,(function*(){const t=e.detail.value;[void 0,null,""].indexOf(t)>-1||(yield this.presentLoading(),setTimeout(()=>{this.eventService.getMunicipyBrachOffice(t).subscribe(e=>{this.municipalities=[],this.municipalities=e.Municipios,this.loading.dismiss()},e=>{this.loading.dismiss()})},1500))}))}selectedMunicipy(e){return Object(c.a)(this,void 0,void 0,(function*(){const t=e.detail.value;[void 0,null,""].indexOf(t)>-1||(yield this.presentLoading(),this.eventService.getEventForMunicipy(t).subscribe(e=>{this.eventsBranchOffice=[],this.eventsBranchOffice=e.Eventos,this.loading.dismiss()},e=>{this.loading.dismiss()}))}))}selectEvent(){return Object(c.a)(this,void 0,void 0,(function*(){const e=yield this.storage.get("sesion");setTimeout(()=>{if(sessionStorage.nombreEvento=this.formConsultEvent.value.event.Evento,this.formConsultEvent.valid){const t={FK_ID_Evento:this.formConsultEvent.controls.event.value.Fk_Id_Evento,strDocumentoUsuario:e.idPersona,dtmFechaRegistro:this.formConsultEvent.controls.dateEvent.value,strGeoposicionamiento:this.formConsultEvent.controls.geoText.value};this.cacheService.saveRegisterEvent(t),this.eventService.createEventResponsible(t).subscribe(e=>{this.router.navigateByUrl("/u/consultEvent/selectRegisterEvent")},e=>{this.router.navigateByUrl("/u/consultEvent/selectRegisterEvent")}),this.formConsultEvent.reset()}else this.Alert()},1e3)}))}changeGeo(e){return Object(c.a)(this,void 0,void 0,(function*(){e.detail.checked?(yield this.presentLoading(),this.geolocation.getCurrentPosition().then(e=>{this.formConsultEvent.controls.geoText.setValue(e.coords.latitude+","+e.coords.longitude),this.loading.dismiss()}).catch(e=>{this.loading.dismiss()})):this.formConsultEvent.controls.geoText.setValue("")}))}presentLoading(){return Object(c.a)(this,void 0,void 0,(function*(){return this.loading=yield this.loadingCtlr.create({mode:"ios",message:"Cargando"}),this.loading.present()}))}Alert(){return Object(c.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({header:"Atenci\xf3n",mode:"ios",message:"Todos los campos son obligatorios.",buttons:["ACEPTAR"]});yield e.present()}))}}return e.\u0275fac=function(t){return new(t||e)(d.Mb(o.b),d.Mb(b.a),d.Mb(l.a),d.Mb(r.bb),d.Mb(u.b),d.Mb(r.a),d.Mb(a.a),d.Mb(s.g))},e.\u0275cmp=d.Gb({type:e,selectors:[["app-consult-event"]],decls:19,vars:1,consts:[["size","2"],["color","tertiary"],["slot","start"],["color","primary","mode","md","defaultHref","/"],["size","10"],[1,"titulo"],[1,"ion-padding"],[3,"formGroup",4,"ngIf"],["size","3"],["size","6"],["mode","ios","expand","block",1,"btn",3,"click"],[3,"formGroup"],["lines","none","mode","ios",1,"item"],["name","calendar","color","primary","slot","start"],["position","stacked"],["mode","ios","display-format","DD MMM YYYY","monthShortNames","Enero, Febrero, Marzo, Abril, Mayo, Junio, Julio, Agosto, Septiembre, Octubre, Noviembre, Diciembre","formControlName","dateEvent","placeholder","DD MM AAAA",1,"bg-light","mt-3","rounded","pl-1","pr-1","ion-padding",3,"value","min","pickerOptions"],["name","business","color","primary","slot","start"],["formControlName","branchOffice","mode","ios","interface","action-sheet","cancelText","CANCELAR","placeholder","Sucursal",1,"bg-light","mt-3","rounded","pl-1","pr-1",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["slot","start",1,"ionthumbnail"],["src","../../../assets/icon/mapa.svg",1,"imgMunicipio"],["formControlName","municipality","mode","ios","interface","action-sheet","cancelText","CANCELAR","placeholder","Municipio",1,"bg-light","mt-3","rounded","pl-1","pr-1",3,"ionChange"],["name","reader","color","primary","slot","start"],["formControlName","event","mode","ios","interface","action-sheet","cancelText","CANCELAR","placeholder","Evento",1,"bg-light","mt-3","rounded","pl-1","pr-1"],["lines","none","mode","ios",2,"height","50px"],["name","pin","color","primary","slot","start"],["color","primary","formControlName","geo",1,"bg-light","mt-3","rounded",3,"ionChange"],["lines","none","mode","ios"],["type","hidden","formControlName","geoText"],[3,"value"]],template:function(e,t){1&e&&(d.Sb(0,"ion-header"),d.Sb(1,"ion-grid"),d.Sb(2,"ion-row"),d.Sb(3,"ion-col",0),d.Sb(4,"ion-toolbar",1),d.Sb(5,"ion-buttons",2),d.Nb(6,"ion-back-button",3),d.Rb(),d.Rb(),d.Rb(),d.Sb(7,"ion-col",4),d.Sb(8,"ion-title",5),d.Cc(9,"Consultar Evento"),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Sb(10,"ion-content",6),d.Ac(11,p,33,7,"form",7),d.Sb(12,"ion-grid"),d.Sb(13,"ion-row"),d.Nb(14,"ion-col",8),d.Sb(15,"ion-col",9),d.Sb(16,"ion-button",10),d.ac("click",(function(){return t.selectEvent()})),d.Cc(17," Seleccionar "),d.Rb(),d.Rb(),d.Nb(18,"ion-col",8),d.Rb(),d.Rb(),d.Rb()),2&e&&(d.Bb(11),d.mc("ngIf",t.formConsultEvent))},directives:[r.w,r.v,r.L,r.p,r.Y,r.i,r.e,r.f,r.W,r.q,i.l,r.h,o.r,o.m,o.f,r.G,r.A,r.x,r.F,r.r,r.ib,o.l,o.d,r.N,i.k,r.V,r.y,r.X,r.b,r.z,r.jb,r.O],styles:["ion-header[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{color:#fff}ion-header[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%], ion-header[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0;background:#95a6b1}ion-header[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding:0}ion-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{margin-top:30px}ion-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{border-radius:20px;border:1px solid #95a6b1;padding:5px}.ionthumbnail[_ngcontent-%COMP%]{margin-right:-10px}.imgMunicipio[_ngcontent-%COMP%]{width:33px;height:33px}.item[_ngcontent-%COMP%]{height:35px}.titulo[_ngcontent-%COMP%]{width:100%!important;font-size:25px!important;text-align:left;padding:10px 0 0}ion-label[_ngcontent-%COMP%]{font-size:20px!important;font-weight:700}.mat-form-field[_ngcontent-%COMP%]{width:100%!important}"]}),e})()},{path:"selectRegisterEvent",loadChildren:()=>n.e(0).then(n.bind(null,"aXVC")).then(e=>e.SelectRegisterEventPageModule)}];let v=(()=>{class e{}return e.\u0275mod=d.Kb({type:e}),e.\u0275inj=d.Jb({factory:function(t){return new(t||e)},imports:[[s.j.forChild(f)],s.j]}),e})();n("R0Ic"),n("dEu6"),n("XNiG"),n("quSY"),n("chLL");let C=(()=>{class e{}return e.\u0275mod=d.Kb({type:e}),e.\u0275inj=d.Jb({factory:function(t){return new(t||e)}}),e})();var E=n("6KbF");n("R1ws"),n("EY2u"),n("VRyK"),n("/uUt"),n("JX91"),n("pLZG"),n("IzEk"),n("tkJt"),n("3+Bf");let O=(()=>{class e{}return e.\u0275mod=d.Kb({type:e}),e.\u0275inj=d.Jb({factory:function(t){return new(t||e)},imports:[[i.c,C,E.f]]}),e})();var M=n("/o1g"),S=n("IRfi"),R=n("A2Vd"),y=n("j14s");let _=(()=>{class e{}return e.\u0275mod=d.Kb({type:e}),e.\u0275inj=d.Jb({factory:function(t){return new(t||e)},imports:[[i.c,o.g,o.p,r.Z,v,O,M.c,y.g,S.c,R.c]]}),e})()}}]);